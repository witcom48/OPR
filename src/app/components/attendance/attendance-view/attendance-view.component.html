<!-- <span style="font-size: 20px;">Attendance</span>&nbsp; <i class="pi pi-angle-right"></i>&nbsp; <small>View Time</small> -->
<p-breadcrumb class="max-w-full" [model]="itemslike" [home]="home"></p-breadcrumb>

<hr>
<p-toast position="top-right"></p-toast> 

<p-confirmDialog [style]="{width: '50vw'}" [baseZIndex]="10000" rejectButtonStyleClass="p-button-text" key="myDialog"></p-confirmDialog>

<p-dialog [(visible)]="searchEmp" [style]="{width: '40vw'}" [position]="position">
    <div class="grid">
        <div class="col-12">
            <app-search-emp></app-search-emp>
        </div>
        <div class="col-12">
            <p-button label="{{title_btn_select[initial_current.Language]}}" icon="pi pi-check" (click)="select_emp()"></p-button> 
            &nbsp;
            <button pButton pRipple type="button" label="{{title_btn_close[initial_current.Language]}}" class="p-button-secondary" (click)="close_searchemp()"></button>                      
        </div>
    </div>
</p-dialog>

<p-dialog header="{{date_work | date:'dd/MM/yyyy'}}" [(visible)]="displayManage" [style]="{width: '45vw'}" [position]="position">
    
    <div class="formgrid grid align-items-end" *ngIf="edit_timecard==true">            
       
        <div class="field col-12 md:col-6">
            <b><label>{{title_project[initial_current.Language]}}</label></b><br>
            <label>{{doGetProjectDetail(selectedTimecard.project_code)}}</label><br>            
        </div>

        <div class="field col-12 md:col-6">
            <b><label>{{title_job[initial_current.Language]}}</label></b><br>
            <label>{{doGetProjobDetail(selectedTimecard.projob_code)}}</label><br>          
        </div>

        <div class="field col-12">
            <span class="timeinput">{{timescan}}</span>
        </div>

        <div class="field col-12 md:col-6">
            <label for="selectedShift">{{title_shift[initial_current.Language]}}</label><br>            
            <p-dropdown [options]="shift_list" optionValue="code" optionLabel="name" [(ngModel)]="this.selectedTimecard.shift_code" [showClear]="true" [style]="{ width: '100%', overflow: 'visible' }"></p-dropdown>       
        </div>  

        <div class="field col-12 md:col-6">
            <label for="selectedShift">{{title_daytype[initial_current.Language]}}</label><br>            
            <p-dropdown [options]="daytype_list" optionValue="code" optionLabel="name" [(ngModel)]="selectedTimecard.timecard_daytype" [showClear]="true" [style]="{ width: '100%', overflow: 'visible' }"></p-dropdown>       
        </div>  
        
        <div class="field col-12 p-2">{{title_beforeot[initial_current.Language]}}</div>  

        <div class="field col-12 md:col-8">
            <div class="grid">
                <div class="col-6 ">
                    <p-calendar [(ngModel)]="date_ch1" dateFormat="dd/mm/yy"  [showTime]="true" inputId="date_ch1"  ></p-calendar>
                </div>
                <div class="col-6">
                    <p-calendar [(ngModel)]="date_ch2" dateFormat="dd/mm/yy" [showTime]="true" inputId="date_ch2"></p-calendar>
                </div>
            </div>  
        </div>
        <div class="field col-12 md:col-4">
            <div class="grid">
                <div class="col-6 ">
                    <p-inputMask mask="99:99" [(ngModel)]="before" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'black','color':'#FFFFFF'}" ></p-inputMask>
                </div>
                <div class="col-6">
                    <p-inputMask mask="99:99" [(ngModel)]="before_app" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'#FFFFFF','color':'green'}"></p-inputMask>
                </div>
            </div>   
        </div>

        <div class="field col-12 p-2">{{title_in[initial_current.Language]}} 1</div>
        <div class="field col-12 md:col-8">
            <div class="grid">
                <div class="col-6 ">
                    <p-calendar [(ngModel)]="date_ch3" dateFormat="dd/mm/yy"  [showTime]="true" inputId="date_ch3"  ></p-calendar>
                </div>
                <div class="col-6">
                    <p-calendar [(ngModel)]="date_ch4" dateFormat="dd/mm/yy" [showTime]="true" inputId="date_ch4"></p-calendar>
                </div>
            </div>  
        </div>
        <div class="field col-12 md:col-4">
            <div class="grid">
                <div class="col-6 ">
                    <p-inputMask mask="99:99" [(ngModel)]="work1" placeholder="HH:mm" (onComplete)="onChangeWork1()" [style]="{'width':'80px','text-align':'center','background-color':'black','color':'#FFFFFF'}" ></p-inputMask>
                </div>
                <div class="col-6">
                    <p-inputMask mask="99:99" [(ngModel)]="work1_app" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'#FFFFFF','color':'green'}"></p-inputMask>
                </div>
            </div>   
        </div>        

        <div class="field col-12 p-2">{{title_out[initial_current.Language]}} 2</div> 
        <div class="field col-12 md:col-8">
            <div class="grid">
                <div class="col-6 ">
                    <p-calendar [(ngModel)]="date_ch7" dateFormat="dd/mm/yy"  [showTime]="true" inputId="date_ch7"  ></p-calendar>
                </div>
                <div class="col-6">
                    <p-calendar [(ngModel)]="date_ch8" dateFormat="dd/mm/yy" [showTime]="true" inputId="date_ch8"></p-calendar>
                </div>
            </div>  
        </div>
        <div class="field col-12 md:col-4">
            <div class="grid">
                <div class="col-6 ">
                    <p-inputMask mask="99:99" [(ngModel)]="work2" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'black','color':'#FFFFFF'}" ></p-inputMask>
                </div>
                <div class="col-6">
                    <p-inputMask mask="99:99" [(ngModel)]="work2_app" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'#FFFFFF','color':'green'}"></p-inputMask>
                </div>
            </div>   
        </div>

        <div class="field col-12 p-2">{{title_break[initial_current.Language]}}</div>  
        <div class="field col-12 md:col-8">
            <div class="grid">
                <div class="col-6 ">
                    <p-calendar [(ngModel)]="date_ch5" dateFormat="dd/mm/yy"  [showTime]="true" inputId="date_ch5"  ></p-calendar>
                </div>
                <div class="col-6">
                    <p-calendar [(ngModel)]="date_ch6" dateFormat="dd/mm/yy" [showTime]="true" inputId="date_ch6"></p-calendar>
                </div>
            </div>  
        </div>
        <div class="field col-12 md:col-4">
            <div class="grid">
                <div class="col-6 ">
                    <p-inputMask mask="99:99" [(ngModel)]="break" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'black','color':'#FFFFFF'}" ></p-inputMask>
                </div>
                <div class="col-6">
                    <p-inputMask mask="99:99" [(ngModel)]="break_app" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'#FFFFFF','color':'green'}"></p-inputMask>
                </div>
            </div>   
        </div>

        <div class="field col-12 p-2">{{title_afterot[initial_current.Language]}}</div> 
        <div class="field col-12 md:col-8">
            <div class="grid">
                <div class="col-6 ">
                    <p-calendar [(ngModel)]="date_ch9" dateFormat="dd/mm/yy"  [showTime]="true" inputId="date_ch9"  ></p-calendar>
                </div>
                <div class="col-6">
                    <p-calendar [(ngModel)]="date_ch10" dateFormat="dd/mm/yy" [showTime]="true" inputId="date_ch10"></p-calendar>
                </div>
            </div>  
        </div>
        <div class="field col-12 md:col-4">
            <div class="grid">
                <div class="col-6 ">
                    <p-inputMask mask="99:99" [(ngModel)]="after" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'black','color':'#FFFFFF'}" ></p-inputMask>
                </div>
                <div class="col-6">
                    <p-inputMask mask="99:99" [(ngModel)]="after_app" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'#FFFFFF','color':'green'}"></p-inputMask>
                </div>
            </div>   
        </div>
               
        <div class="field col-12 md:col-8">           
            <div class="grid">
                <div class="col-6 p-2" >
                    {{title_late[initial_current.Language]}}
                </div>
                <div class="col-6 p-2">
                    {{title_leave[initial_current.Language]}}
                </div>
                <div class="col-3 ">
                    <p-inputMask mask="99:99" [(ngModel)]="late" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'black','color':'#FFFFFF'}" ></p-inputMask>
                </div>
                <div class="col-3">
                    <p-inputMask mask="99:99" [(ngModel)]="late_app" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'#FFFFFF','color':'green'}"></p-inputMask>
                </div>
                <!-- <div class="col-3 ">
                    <p-inputMask mask="99:99" [(ngModel)]="leave" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'black','color':'#FFFFFF'}" ></p-inputMask>
                </div> -->
                <div class="col-6">
                    <p-inputMask mask="99:99" [(ngModel)]="leave_app" placeholder="HH:mm" [style]="{'width':'80px','text-align':'center','background-color':'#FFFFFF','color':'green'}"></p-inputMask>
                </div>
            </div>  
        </div>
        <div class="field col-12 md:col-4">
            <div class="field-checkbox">
                <p-checkbox [binary]="true" [(ngModel)]="selectedTimecard.timecard_lock" inputId="timecard_lock"></p-checkbox>
                <label for="timecard_lock">{{title_lock[initial_current.Language]}}</label>
                &nbsp;&nbsp;&nbsp;&nbsp;
                <p-checkbox [binary]="true" [(ngModel)]="selectedTimecard.timecard_deduct" inputId="timecard_deduct"></p-checkbox>
                <label for="timecard_deduct">{{title_deduct[initial_current.Language]}}</label>
            </div>
        </div>
        
        <div class="field col-12">
                <h4>{{title_document[initial_current.Language]}}</h4>
                
                <p-table #dtReqdoc [value]="reqdoc_list"  styleClass="p-datatable-sm" >

                    <ng-template pTemplate="header">
                        <tr>  
                            <th>{{title_docno[initial_current.Language]}}</th> 
                            <th>{{title_doctype[initial_current.Language]}}</th> 
                            <th>{{title_fromdate[initial_current.Language]}}</th> 
                            <th>{{title_todate[initial_current.Language]}}</th>   
                            <th>{{title_detail[initial_current.Language]}}</th>                                                          
                        </tr>                        
                    </ng-template>

                    <ng-template pTemplate="body" let-reqdoc>
                        <tr [pSelectableRow]="reqdoc" >        
                            <td>{{reqdoc.docno}}</td>  
                            <td>{{reqdoc.doctype}}</td>  
                            <td>{{reqdoc.fromdate | date:'dd/MM/yyyy'}}</td>  
                            <td>{{reqdoc.todate | date:'dd/MM/yyyy'}}</td>                               
                            <td>{{reqdoc.detail}}</td>                               
                        </tr>
                    </ng-template>    
                </p-table>   
                
        </div>
         
        <div class="field col-12">
            <p-button label="{{title_save[initial_current.Language]}}"icon="pi pi-save"[disabled]="hasTruePeriodCloseta"(click)="timecard_summit()"></p-button>
            &nbsp;
            <button pButton pRipple type="button" label="{{title_close[initial_current.Language]}}" class="p-button-secondary" (click)="timecard_cancel()"></button>            
        </div>
    </div>
    
</p-dialog>

<div class="grid">
    <!-- <div class="col-12">    
        <div class="grid">
            <div class="field col-12 md:col-5">
                <table style="width: 100%">
                    <tr>
                        <td style="width: 20px;">
                            <i class="pi pi-angle-left" style="font-size: 2rem" (click)="doBackWorker()"></i>
                        </td>
                        <td style="width: 150px;">
                            <input id="lastname2" type="text" value="{{worker_code}}" style="text-align: center;" class="text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full">
                        </td>
                        <td style="width: 20px;">
                            <i class="pi pi-angle-right" style="font-size: 2rem" (click)="doNextWorker()"></i>
                        </td>
                        <td style="width: 20px;">
                            <i class="pi pi-search" ></i>
                        </td>
                        <td style="width: 250px;" align="left">
                            <input id="lastname2" type="text" value="{{worker_name}}" style="width: 250px;" class="text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full">
                        </td>
                    </tr>
                </table>
            </div>
            <div class="field col-12 md:col-7">
                <table class="table_summary_">
                    <tr>
                        <td>
                            <div class="main_div">
                                <span class="spn_value">10</span>
                                <div class="sub_div">
                                    <span class="spn_title">วันทำงาน</span>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="main_div">
                                <span class="spn_value">10:00</span>
                                <div class="sub_div">
                                    <span class="spn_title">ล่วงเวลา</span>
                                </div>
                            </div>
                        </td>   
                        <td>
                            <div class="main_div">
                                <span class="spn_value">1</span>
                                <div class="sub_div">
                                    <span class="spn_title">วันลา</span>
                                </div>
                            </div>
                        </td>   
                        <td>
                            <div class="main_div">
                                <span class="spn_value">0</span>
                                <div class="sub_div">
                                    <span class="spn_title">ขาดงาน</span>
                                </div>
                            </div>
                        </td>   
                        <td>
                            <div class="main_div">
                                <span class="spn_value">00:50</span>
                                <div class="sub_div">
                                    <span class="spn_title">สาย</span>
                                </div>
                            </div>
                        </td>                                                                  
                    </tr>
                </table>  
            </div>
        </div>   
    </div> -->

    <div class="col-6">
        <table style="width: 100%; ">
            <tr>               
                <td style="width: 20px;">
                    <i class="pi pi-angle-left" style="font-size: 2rem" (click)="doBackWorker()"></i>
                </td>
                <td style="width: 150px;">
                    <input id="worker_code" type="text" value="{{worker_code}}" style="text-align: center; " class="text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full" readonly>
                </td>
                <td style="width: 20px;">
                    <i class="pi pi-angle-right" style="font-size: 2rem" (click)="doNextWorker()"></i>
                </td>
                <td style="width: 20px;">
                    <i class="pi pi-search" (click)="open_searchemp()"></i>
                </td>
                <td style="width: 250px;" align="left">
                    <input id="worker_name" type="text" value="{{worker_name}}" style="width: 250px;" class="text-base text-color surface-overlay p-2 border-1 border-solid surface-border border-round appearance-none outline-none focus:border-primary w-full" readonly>
                </td>
            </tr>
        </table>
    </div>
    <div class="col-6">
        &nbsp;
    </div>
    
    <div class="col-12">
        <p-menubar [model]="menu_timecard"></p-menubar>        
        <p-table #dtTime [value]="timecard_list"  styleClass="p-datatable-sm" [tableStyle]="{'min-width': '190rem'}" [scrollable]="true" scrollHeight="700px" [virtualScroll]="true" selectionMode="single" [(selection)]="selectedTimecard" (onRowSelect)="onRowSelectTimecard($event)" dataKey="index"
        [rows]="50" [showCurrentPageReport]="true" [rowsPerPageOptions]="[50,100,150]" 
        [paginator]="true"  currentPageReportTemplate="{{title_page_from[initial_current.Language]}} {first} {{title_page_to[initial_current.Language]}} {last} {{title_page_total[initial_current.Language]}} {totalRecords} {{title_page_record[initial_current.Language]}} "
        [globalFilterFields]="['shift_code','timecard_daytype', 'modified_by']"
        >
            <ng-template pTemplate="header">
                <tr>  
                    <th>{{title_date[initial_current.Language]}}</th> 
                    <th>{{title_project[initial_current.Language]}}</th> 
                    <th>{{title_job[initial_current.Language]}}</th>                       
                    <th style="width: 100px;">{{title_shift[initial_current.Language]}}</th>
                    <th style="width: 100px;">{{title_daytype[initial_current.Language]}}</th>   
                    <th>{{title_normalin[initial_current.Language]}}</th>
                    <th>{{title_normalout[initial_current.Language]}}</th>                                    
                    <th>{{title_beforeot[initial_current.Language]}}</th>   
                    <th>{{title_beforeot[initial_current.Language]}} ({{title_approve[initial_current.Language]}})</th>   
                    <th>{{title_work[initial_current.Language]}}</th>   
                    <th>{{title_work[initial_current.Language]}} ({{title_approve[initial_current.Language]}})</th>                    
                    <th>{{title_afterot[initial_current.Language]}}</th>   
                    <th>{{title_afterot[initial_current.Language]}} ({{title_approve[initial_current.Language]}})</th>                       
                    <th>{{title_late[initial_current.Language]}}</th>   
                    <th>{{title_late[initial_current.Language]}} ({{title_approve[initial_current.Language]}})</th>
                    <th>{{title_leave[initial_current.Language]}}</th>   
                    <!-- <th>{{title_leave[initial_current.Language]}} ({{title_approve[initial_current.Language]}})</th> -->
                    <th style="width: 200px;">{{title_modified_by[initial_current.Language]}}</th>
                    <th>{{title_modified_date[initial_current.Language]}}</th>                                                                 
                </tr>
                
            </ng-template>

            <ng-template pTemplate="body" let-timecard>
                <tr [pSelectableRow]="timecard" >        
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{timecard.timecard_workdate | date:'dd/MM/yyyy'}}</td>                                
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{timecard.project_code}}</td>   
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{timecard.projob_code}}</td>   
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{timecard.shift_code}}</td>   
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{timecard.timecard_daytype}}</td>       
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{timecard.timecard_ch3 | date:'dd/MM/yyyy HH:mm'}}</td>       
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{timecard.timecard_ch4 | date:'dd/MM/yyyy HH:mm'}}</td>       
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{doConvertHHMM(timecard.timecard_before_min)}}</td>       
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{doConvertHHMM(timecard.timecard_before_min_app)}}</td>       
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{doConvertHHMM(timecard.timecard_work1_min)}}</td>       
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{doConvertHHMM(timecard.timecard_work1_min_app)}}</td>       
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{doConvertHHMM(timecard.timecard_after_min)}}</td>    
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{doConvertHHMM(timecard.timecard_after_min_app)}}</td>   
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{doConvertHHMM(timecard.timecard_late_min)}}</td>   
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{doConvertHHMM(timecard.timecard_late_min_app)}}</td> 
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{doConvertHHMM((timecard.timecard_leavepay_min + timecard.timecard_leavededuct_min))}}</td> 
                    <!-- <td></td>                                      -->
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{timecard.modified_by}}</td>      
                    <td [ngClass]="getClass(timecard.timecard_color, timecard.timecard_daytype)">{{timecard.modified_date | date:'dd/MM/yyyy HH:mm'}}</td>
                </tr>
            </ng-template>    
        </p-table>
    </div>
    
    <div class="col-12">
        <table>
            <tr>
                <td class="daytype_A" style="width: 30px;">&nbsp;</td>
                <td>Absent</td>
                <td class="daytype_C" style="width: 30px;">&nbsp;</td>
                <td>Comanyday</td>
                <td class="daytype_H" style="width: 30px;">&nbsp;</td>
                <td>Holiday</td>
                <td class="daytype_L" style="width: 30px;">&nbsp;</td>
                <td>Leaveday</td>
                <td class="normal" style="width: 30px;">&nbsp;</td>
                <td>Normalday</td>
                <td class="daytype_O" style="width: 30px;">&nbsp;</td>
                <td>Offday</td>
                <td class="timecard_edit_" style="width: 30px;">&nbsp;</td>
                <td>EditTime</td>
            </tr>
        </table>
        
    </div>


</div>